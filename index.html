<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindEase | Daily Mood Journal</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-100 min-h-screen font-sans">

    <div id="auth-section" class="flex flex-col items-center justify-center h-screen">
        <div class="bg-white p-8 rounded-3xl shadow-xl w-96 text-center border border-purple-200">
            <h1 class="text-3xl font-bold text-blue-600 mb-2">MindEase</h1>
            <p class="text-gray-500 mb-6">Secure MFA Login</p>
            <input type="email" id="email" placeholder="Enter your email" class="w-full p-3 rounded-xl border mb-4 focus:ring-2 focus:ring-blue-400 outline-none">
            <button onclick="handleLogin()" id="login-btn" class="w-full bg-blue-500 text-white py-3 rounded-xl font-semibold hover:bg-blue-600 transition">Send OTP Code</button>
            <div id="otp-input" class="hidden mt-4">
                <input type="text" id="otp-code" placeholder="6-digit code" class="w-full p-3 rounded-xl border mb-4">
                <button onclick="verifyOtp()" class="w-full bg-green-500 text-white py-3 rounded-xl font-semibold">Verify & Enter</button>
            </div>
        </div>
    </div>

    <div id="app-section" class="hidden max-w-2xl mx-auto py-10 px-4">
        <header class="flex justify-between items-center mb-8">
            <h2 class="text-2xl font-bold text-blue-800">Hello, <span id="user-display">User</span></h2>
            <button onclick="supabase.auth.signOut().then(() => location.reload())" class="text-sm text-red-500 underline">Logout</button>
        </header>

        <div class="bg-white p-6 rounded-3xl shadow-md mb-8">
            <h3 class="text-lg font-semibold mb-4 text-gray-700">How are you feeling right now?</h3>
            <div class="flex justify-between mb-6">
                <button onclick="selectMood('ğŸ˜Š', 'Great')" class="mood-btn text-4xl hover:scale-125 transition">ğŸ˜Š</button>
                <button onclick="selectMood('ğŸ™‚', 'Good')" class="mood-btn text-4xl hover:scale-125 transition">ğŸ™‚</button>
                <button onclick="selectMood('ğŸ˜', 'Okay')" class="mood-btn text-4xl hover:scale-125 transition">ğŸ˜</button>
                <button onclick="selectMood('ğŸ˜”', 'Down')" class="mood-btn text-4xl hover:scale-125 transition">ğŸ˜”</button>
                <button onclick="selectMood('ğŸ˜¢', 'Struggling')" class="mood-btn text-4xl hover:scale-125 transition">ğŸ˜¢</button>
            </div>
            <textarea id="note" placeholder="Optional: What's on your mind?" class="w-full p-4 bg-gray-50 border rounded-2xl h-24 mb-4 outline-none"></textarea>
            <button onclick="saveMood()" class="w-full bg-purple-500 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-purple-600">Save Journal Entry</button>
        </div>

        <button onclick="toggleSafety()" class="w-full bg-red-100 text-red-600 py-4 rounded-2xl border-2 border-red-200 font-bold mb-8">I'M NOT OKAY (Help)</button>

        <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold text-gray-800">Your History</h3>
            <button onclick="togglePrivacy()" id="privacy-btn" class="text-sm bg-gray-200 px-3 py-1 rounded-full">Hide Content: OFF</button>
        </div>
        <div id="history-list" class="space-y-4">
            </div>
    </div>

    <div id="safety-modal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-6">
        <div class="bg-white p-8 rounded-3xl max-w-md w-full text-center">
            <h2 class="text-2xl font-bold text-red-600 mb-4">You're not alone.</h2>
            <p class="text-gray-600 mb-6">Take a deep breath. Try the 5-4-3-2-1 technique. Focus on 5 things you can see...</p>
            <div class="space-y-4">
                <a href="tel:14416" class="block w-full bg-red-600 text-white py-4 rounded-xl font-bold text-xl">Call 14416</a>
                <button onclick="toggleSafety()" class="text-gray-400">Close</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
